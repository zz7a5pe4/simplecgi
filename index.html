<!DOCTYPE html>
<html>
  <head runat="server">
     <title>Lesson 1 - Demo 1 - IFrame "Ajax"</title>
     <script language="javascript">
        var autoload = 0
         function refresh()
         {
             post_to_url("http://127.0.0.1:8000/ping", {'q':'a'})
             autoload = window.setInterval('autoscroll()', 1000)
         }
	function post_to_url(path, params, method) {
            method = method || "post"; // Set method to post by default, if not specified.

            // The rest of this code assumes you are not using a library.
            // It can be made less wordy if you use one.
            var form = document.createElement("form");
            form.setAttribute("method", method);
            form.setAttribute("action", path);
	        form.setAttribute("target", "rf");
            for(var key in params) {
                if(params.hasOwnProperty(key)) {
                    var hiddenField = document.createElement("input");
                    hiddenField.setAttribute("type", "hidden");
                    hiddenField.setAttribute("name", key);
                    hiddenField.setAttribute("value", params[key]);

                    form.appendChild(hiddenField);
                 }
            }

            document.body.appendChild(form);
            form.submit();
        }

        function autoscroll() {
            var pos_y =  document.getElementById("resultframe").contentWindow.document.body.scrollHeight;
            document.getElementById("resultframe").contentWindow.scrollTo(0, pos_y );
           }

        function stop(){
            window.clearInterval(autoload)
        }
     </script>
  </head>
<body>

<!-- First name: <input type="text" name="FirstName" value="Mickey" /><br />
Last name: <input type="text" name="LastName" value="Mouse" /><br /> -->
<input type="submit" value="Submit" onclick="refresh()"/>
</br>
<iframe name="rf" id="resultframe" width=800 height=60 onload="stop()"></iframe>

</body>
</html>
